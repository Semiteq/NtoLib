# Ошибки при развёртывании и регистрации NtoLib

## Описание проблемы

После распаковки релизного архива и регистрации `NtoLib.dll` через `netreg.exe` могут возникать ошибки различного характера. Большинство из них связаны с тем, что Windows блокирует файлы, загруженные из сети (скачанные архивы, вложения из писем).

---

## 1. Ошибка GUID при запуске проекта / блок не отображается

### Симптомы

При запуске проекта MasterSCADA возникает неизвестная ошибка с указанием GUID блока, либо блок отсутствует в палитре.

### Причина

Windows пометил файлы из распакованного архива как заблокированные (Zone.Identifier). MasterSCADA не может загрузить заблокированную DLL.

### Решение

Открыть свойства файла `NtoLib.dll` (и других файлов из архива) и снять блокировку:

![unlock](img/unlock.jpg)

Альтернативно, можно разблокировать файл через PowerShell:

```powershell
Unblock-File -Path "C:\path\to\NtoLib.dll"
```

---

## 2. Ошибка регистрации COM-объекта через NetReg

### Симптомы

При запуске `NtoLib_reg.bat` (вызов `netreg.exe`) возникает ошибка регистрации:

![netreg](img/netreg.jpg)

### Причина

Та же -- Windows заблокировал DLL после распаковки из архива.

### Решение

Разблокировать `NtoLib.dll` перед регистрацией (см. раздел 1).

---

## 3. Ошибка перехода на экран с блоком / ошибка при старте проекта

### Симптомы

При переходе на экран с блоком или при старте проекта возникает ошибка с кодом, не относящимся к SCADA:

![compile](img/compile.jpg)

### Причина

Возможны два варианта:

1. **Заблокированная DLL** -- см. раздел 1.
2. **Ошибка сборки** -- не все зависимые DLL были упакованы в `NtoLib.dll` при ILRepack. Если в сообщении указан код ошибки -- это исключение .NET, по которому можно найти информацию.

### Решение

1. Убедиться, что `NtoLib.dll` разблокирована.
2. Если разблокировка не помогла -- проверить, что используется корректная сборка из официального релиза. При самостоятельной сборке убедиться, что скрипт `Build/Package.ps1` завершился без ошибок.
