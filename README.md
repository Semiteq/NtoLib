# NtoLib

![Build status](https://img.shields.io/badge/build-nuke-blue)
![Target](https://img.shields.io/badge/target-.NET%20Framework%204.8-lightgrey)
![MasterSCADA](https://img.shields.io/badge/MasterSCADA-3.12-informational)

<p align="center"><img src=./Resources/img/logo.png/></p>

Библиотека пользовательских функциональных блоков и инфраструктуры для **MasterSCADA 3.12** (.NET Framework 4.8),
ориентированная на поддержку сложных технологических установок (эпитаксия плазмохимия и смежные системы).

## Структура репозитория

### Библиотека NtoLib 

- Каталог: `NtoLib`
- Описание: исходный код NtoLib.dll. Подробную документацию на функционал библиотеки смотри по [ссылке](./NtoLib/readme.md).

### Тесты

- Каталог: `Tests/`
- Содержит проект `Tests` для автоматизированного тестирования NtoLib (юнит- и интеграционные проверки ключевых сценариев использования библиотеки). Подробнее см. [документацию](./Tests/README.md).

### Сборка

- Каталог: `Build/`
 - Сборка происходит средствами dotnet и shell скриптами. См. [документацию](./build/readme.md) по сборке.


## Развёртывание в MasterSCADA

1. Собранный релизный архив распаковать и скопировать `NtoLib.dll` в каталог установки MasterSCADA.
2. Сопутствующие конфигурационные файлы отдельных блоков поместить в `C:\DISTR\Config`, если не указано иное в документации конкретного блока.
3. Зарегистрировать библиотеку через `NtoLib_reg.bat` или `netreg.exe`.
4. Перезапустить MasterSCADA и добавить нужные функциональные блоки в проект.

## FAQ

### При запуске проекта возникает неизвестная ошибка с указанием GUID блока и/или сам блок не отображается

Нужно проверить что Windows разрешил запуск всех dll, распакованных из архива, см скриншот ниже:

![unlock](./Resources/img/unlock.jpg)

Необходимо разблокировать файлы.

### При выполнении регистрации COM-объекта с NetReg (запуск NtoLib_reg.bat) возникает ошибка как ниже: 

![netreg](./Resources/img/netreg.jpg)

Причина та же, смотри пункт про разблокировку файла.

### При переходе на экран с блоком или при старте проекта возникает ошибка перехода (с не SCADA ошибкой), как на скриншоте:

![compile](./Resources/img/compile.jpg)

Возможно произошла ошибка сборки и не все зависимые dll были запакованы в NtoLib.dll. Если показывается код ошибки - ошибка выброшена не SCADA, т.е. по ней можно найти информацию.
